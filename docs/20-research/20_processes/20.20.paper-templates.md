---
layout: default
title: 20.20 Paper template
parent: 20 Research Processes
grand_parent: Research
nav_order: 21
---

# 20.20 Paper template
{: .no_toc }

{: .highlight }
See [markdown kitchen sink](../../10-lab/10_processes/10.07.markdown.html)

The paper development process is based on markdown, git, Docker, pandoc, and csl.
The goal is to support the collaborative writing process effectively, building on powerful open source tools, and supporting efficient production of documents for submission.

Start your manuscript development by using the [Markdown template](https://github.com/digital-work-lab/paper-template){: target="_blank"}. This template provides a structured format for your initial drafts, helping to organize content efficiently.

{: .text-center}
[Create new paper repository](#setup){: .btn .btn-green target="_blank"}
{: .text-center}

## Table of contents
{: .no_toc .text-delta }

- TOC
{:toc}

## Setup

This section explains how to install the environment and build the paper.
[Git](https://git-scm.com/), [Docker](https://www.docker.com/) and make are required.
The following steps describe how to

1. Set up the repository (create a new one or contribute to an existing one),
2. Set up the paper production pipeline, and
3. Build the paper

The manuscript template creates the following files (additional [files for the analysis](20.21.analysis-templates.html) can be added)

```text
├── figures       <- directory contains all conceptual figures
├── output        <- directory contains all output, such as data plots and
│                    tables, which is generated by the scripts (do not store
│                    anything else that is not generated by the scripts in this
│                    directory)
├── Dockerfile    <- describes the pandoc container for building the paper
│                    (called by the Makefile)  
├── Makefile      <- contains instructions to build the paper (as pdf or docx),
│                    and run the analyses (if a Makefile exists in the analysis
│                    directory)
├── paper.md      <- contains the paper
├── readme.md     <- contains summaries of the paper's revisions (completed and
│                    ongoing). Revision sheets are created from this document.
└── .gitignore    <- contains a list of files that are excluded from git
                     versioning (e.g., paper.pdf, which would create conflicts
                     when merging changes)
```

To avoid handling redundant and possibly outdated files across paper projects, it is recommended to use shared templates, and the styles provided by the CSL community.

```text
├── styles        <- a symlink to a local clone of the csl styles
|                    https://github.com/citation-style-language/styles
├── templates     <- a symlink to the shared template repository
```

Symlinks to shared directory are ignored in [git versioning](.gitignore).
Any of the templates (\*.docx, \*.tex), or styles (\*.csl) can also be versioned in the individual paper repository.
This can be accomplished by using the code in comments at the beginning of the [Makefile](Makefile).

### 1: Set up the repository

Option 1: Create a new repository

- Select a short and pronounceable title for the paper
- Do not refer to papers by their target journal (e.g., "the Journal of Information Technology paper")

```shell
git clone git@github.com:digital-work-lab/paper-template.git
# MANUALLY rename the folder using a short project title
# remove the .git directory containing older versions
rm -rf .git
# repo setup:
git init
# MANUALLY create paper (update titles etc.)
mkdir analysis data figures output
pre-commit install
cd .git/hooks
cp ../../post-xxx-sample.txt post-checkout
cp post-checkout post-merge
cp post-checkout post-commit
rm ../../post-xxx-sample.txt
cd ../..
git add .
git commit -m 'initial commit'
make pdf
# connect to git remote
# MANUALLY update url in the following line
git remote add origin https://github.com/....
git branch -M main
git push -u origin main
# MANUALLY invite coauthors/provide access to the remote repository
# git clone template-repository
# git clone https://github.com/citation-style-language/styles
# MANUALLY symlink the templates and styles repos
```

Option 2: Contribute to an existing repository

```shell
# pull repository
git clone https://...
pre-commit install
```

### 2: Set up the paper production pipeline

```shell
# MANUALLY set up the paths for the shared directories or clone them using the following commands:
git clone git@github.com:citation-style-language/styles.git ../styles
git clone git@github.com:digital-work-lab/templates.git ../templates
ln -s ../styles
ln -s ../templates
# Build the Docker container
docker build -t pandoc_dockerfile .
# MANUALLY select a citation style by updating the link at the beginning of the Makefile
# MANUALLY select templates for docx/tex by updating the link at the beginning of the Makefile
```

### 3: Build the paper

```shell
make pdf
make docx
```

## Workflow

Changes are tracked by the collaborative versioning system git.
Tutorials on git are available online ([1](https://learngitbranching.js.org/), [2](https://github.com/jlord/git-it-electron)).

### Editing the paper

The [paper](paper.md) is written in markdown.
Useful guides on markdown are available online ([1](https://bookdown.org/yihui/rmarkdown/), [2](https://bookdown.org/yihui/rmarkdown-cookbook/)).
Several editors are available for markdown documents, for example:

- [Atom](https://shd101wyy.github.io/markdown-preview-enhanced/#/) with [markdown-preview-enhanced](https://github.com/shd101wyy/markdown-preview-enhanced)
- [Panwriter](https://panwriter.com/)

The bibliography is stored as a bib file and versioned by git.
It can be edited using tools like [JabRef](https://github.com/JabRef/jabref).
It is recommended to configure save actions to [store titles as sentence case](https://docs.jabref.org/finding-sorting-and-cleaning-entries/saveactions#sentence-case), [normalize names of persons for author fields](https://docs.jabref.org/finding-sorting-and-cleaning-entries/saveactions#normalize-names-of-persons), and to [normalize page numbers](https://docs.jabref.org/finding-sorting-and-cleaning-entries/saveactions#normalize-page-numbers).
Changes in the bib-file should be checked before committing and adding {} to protect cases when necessary (e.g., `{J}ab{R}ef`).

- Begin each sentence in a new line to make the history more readable and to make merging easier (see [semantic line breaks](https://sembr.org/)).

A very useful possibility is to include comments throughout the markdown document:

```markdown
<!-- Comment can be used to add further explanations, links to references/resources, or to keep parts of the paper that were shortened -->
```

Papers are cited using the citation keys in the bib-file and the citation syntax @Webster2002 or [@Webster2002].
Groups of in-text citations should be sorted alphabetically (especially if a prefix is used), i.e., use [e.g., @Bacharach1989; @Gregor2006a] instead of [e.g., @Gregor2006a; @Bacharach1989].

To add papers that are cited in the figure to the reference section, include the following in the YAML header of paper.md:

```markdown
nocite: |
  @citation_key
```

Further Information on the [citation syntax](https://pandoc.org/MANUAL.html#citation-syntax) is available in the pandoc manual.

Figures can be included as follows and referred to as @fig:distribution.
Further information on [pandoc-crossref](https://lierdakil.github.io/pandoc-crossref/) is available online.

```markdown
![Figure Caption](figures/figure.jpg){#fig:distribution width=300px}
```

To ensure compatibility with pandoc word and latex conversion, figures should be included as jpg/png.
For the final versions, vector graphics (PDF, EMF) should be included for Latex/Word respectively.

Formulas can be included as follows:

```latex
$$ P_i(x) = \sum_i a_i x^i $$ {#eq:eqn1}
```

| T1   | T2   | T3   |
| ---- | ---- | ---- |
| C11  | C12  | C13  |
| C21  | C22  | C23  |
| C31  | C32  | C33  |

: Table example {#tbl:table1}

Pantable:

```text

```table
---
caption: '*Awesome* **Markdown** Table {#tbl:short_ref}'
alignment: RC
table-width: 2/3
markdown: True
---
First row,defaulted to be header row,can be disabled
1,cell can contain **markdown**,"It can be aribrary block element:

- following standard markdown syntax
- like this"
2,"Any markdown syntax, e.g.",E = mc^2^

```

Footnotes can be added [^1].

  [^1]: Example footnote.

Formatting the bibliography (*.bib file)

- Title field: use sentence case (e.g., "On the origin of species", not "On the Origin of Species"). CSL styles that require title case will use an automatic title-case conversion ([1](https://citationstyles.org/authors/#/titles-in-sentence-and-title-case)).

- Journal field: use long version (e.g., "Journal of Information Technology", not "JIT"). For CSL styles that require abbreviations, temporarily replace the journal field in the bib-file since CSL does not handle style-specific journal abbreviations ([1](https://citationstyles.org/authors/#/csl-limitations)). JSON-files containing journal abbreviations can be passed to pandoc using the [citation-abbreviations](https://pandoc.org/MANUAL.html#option--citation-abbreviations) field.

- Inproceedings: when using crossrefs (e.g., `crossref = {icis2010}`) for conference papers, the year and month field should _not_ be set, only the original \@Proceedings entry should include the date formatted as follows: `date    = {2015-12-13/2015-12-16}`.

### Contributing changes

- Check the git-diff (gitk) before committing changes.
- Use the following commit message format (do not start commit message with #3):

```shell
git commit -m 'address limitations [iss28]'
```

- Commit minor changes directly to the `polishing` branch, use dedicated branches otherwise (especially when changes need to be discussed in a pull-request).
- Create a single branch for issues that are related (e.g., group all issues referring to the introduction in the branch `update_introduction`).
- Example:

```shell
git switch main
git checkout -b iss12
```

- While working locally on the iss12, rebase it on main when the main branch has been updated by coauthors (for better management of the history):

```shell
git switch iss12
git rebase main
```

- Once the branch is ready for review, revisions, and merging, share it:

```shell
git push iss12
# set the upstream branch as suggested
```

- Do not rebase shared branches while working on it.
- Discuss, revise and merge on shared branches (github.com).
- Merge when changes have been confirmed:

```shell
git switch main
git merge --squash iss12
git push
```

### Retrieving changes from coauthors

- Check out remote branch:

```shell
git switch -c iss12 --track origin/iss12
```

- When your repository has local changes (commits): pull-rebase to avoid unnecessary merge commits:

```shell
git pull --rebase
```

- When your repository has local changes (uncommitted): stash and pull-rebase:

```shell
git stash
git pull --rebase
git stash apply
```

### Collaboration with Word users

Whenever possible, **ask active coauthors to modify the paper.md file**.

Otherwise:

- To share: create a commit with the latest changes.
- Export paper as word file.
- Filename: increment the version number with every docx file that is shared externally (example: `Manuscript_v11.docx`).
- For you own reference, you may store the same file in a local directory, including the hash-id of the latest commit as the second part of the filename  (example: `Manuscript_v11 d091j209fs8.docx`).
This can be useful to track the mapping between version numbers and the corresponding hash-id (git history).

- When receiving feedback in the docx: always make sure that feedback (including tracked and untracked changes) is transferred to the [paper](paper.md) manually.
  - Create PDF from word with tracked changes (it is important to know which ones have/have not been addressed rather than having a Word-file in which all changes have been accepted/issues addressed - this is done in the paper.md.).
  - While addressing the comments: highlight suggestions that have been addressed in green (strike out suggestions that will not be addressed), and possibly provide comments on how issues have been addressed (why this way?).
  - Typos and very minor comments: address in one commit (e.g., "fix spelling errors")
  - Other comments: address in individual commits (possibly including the comment-ids generated by the word-to-pdf export in the commit message)
  - Major issues: include in the readme.md (possibly discuss with coauthors) and address in a separate branch

### Submitting the paper

See [pre-submission checklist](20.30.pre-submission.html)

### Revising the paper

See [revision checklist](20.32.revision.html)

## Principles

This section summarizes underlying architectural principles and considerations.

- Minimal functionality: the most frequent use cases (writing, citing, creating submission files in docx/latex format with different templates and citation styles) must be supported in a highly efficient way.
More complex functionality (such as tables with merged cells and detailed formatting) is used less frequently (requiring less effort if not supported in an efficient way).
It may also create fewer problems (e.g., merging complex tables - as in Word/comparisons of tables)

Advantages of the markdown/pandoc workflow:

- Separation of content and format
- Collaboration and versioning of text with git
- Relying on active open source projects such as the [CSL](https://citationstyles.org/) standard
- Flexibility regarding the bibliography type (pandoc supports .bib, .enl, ...)
- Combined writing and comments in the same document
- Reproducibility across platforms
- Generating docx/tex/pdf as output

Since the underlying open source projects (especially CSL, pandoc, pandoc-citeproc) evolve constantly, it is recommended to work with the latest versions.
This is a limitation of the popular [manubot project](https://github.com/manubot/rootstock) or [pandoc scholar](https://github.com/pandoc-scholar/pandoc-scholar), which work with old versions of pandoc (which may be hard to update).

Possible extensions (lua-filters): [bibexport](https://github.com/pandoc/lua-filters/tree/master/bibexport), [abstract-to-meta](https://github.com/pandoc/lua-filters/tree/master/abstract-to-meta), [spellcheck](https://github.com/pandoc/lua-filters/tree/master/spellcheck), [wordcount](https://github.com/pandoc/lua-filters/tree/master/wordcount).
